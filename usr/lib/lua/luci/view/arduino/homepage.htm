<%
local http = require("luci.http")
http.prepare_content("text/html; charset=utf-8")
-%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="initial-scale=1.0, user-scalable=no"/>
  <link rel="stylesheet" type="text/css" href="<%= resource %>/arduino/style.ugly.css" />
  <title>Y&uacute;n &#20113;</title>
</head>
<body>
<div id="container">
  <div id="header">
    <div class="wrapper">
      <h1>Y&uacute;n &#20113;</h1>

      <div id="logo"><img src="<%= resource %>/arduino/logo.png" alt="Y&uacute;n &#20113;"/></div>
    </div>
  </div>
  <div id="content">
    <div class="wrapper">
Welcome to <%= hostname %>, your Arduino Y&uacute;n &#20113;<br/><br/>

This is my current network connection:<br/>
<% for name, data in pairs(ifaces) do %>
<strong>
<% if data["pretty_name"] then %>
<%= data["pretty_name"] %> (<%= name %>)
<% else %>
Interface <%= name %>
<% end %>
</strong>
<% if data["address"] then %>
<br/>
Address: <%= data["address"] %>
<br/>
Netmask: <%= data["netmask"] %>
<% else %>
(disconnected)
<% end %>
<br/>
MAC Address: <%= data["mac"] %><br/>
Received <%= data["rx"] %>, trasmitted <%= data["tx"] %><br/>
<br/>
<% end %>

<form method="get" action="<%= pcdata(controller .. '/arduino/config') %>">
  <ul>
    <li>
      <div class="input_container">
        <input class="btTxt submit saveForm" type="submit" value="Configure" onclick="javascript:return goto('<%= pcdata(controller .. '/arduino/config') %>');">
      </div>
    </li>
  </ul>
</form>

<% if update_file then %>
<br/>
<br/>
A file named <%= update_file %> has been found on the SD card.<br/>
Do you wish to use it to reset your Y&uacute;n &#20113;?<br/>
<strong>ATTENTION!!</strong> You'll lose everything stored on the Y&uacute;n &#20113; and it will then look brand new! Back it up before proceeding!<br/>

<form method="post" action="<%= pcdata(controller .. '/arduino/reset_board') %>">
  <ul>
    <li>
      <div class="input_container">
        <input class="btTxt submit saveForm" type="submit" name="button" value="Reset" onclick="javascript:return confirm('Are you sure you want to RESET the Y&uacute;n &#20113;?\nThis operation is irreversible!!');">
      </div>
    </li>
  </ul>
</form>
<% end %>

<% if last_log then %>
<br/>
There's been a problem last time I tried configuring wifi. Check the following log:<br/>
<textarea rows="20">
<% for i,line in pairs(last_log) do %><%= line %>
<% end %>
</textarea>
<script language="javascript">document.getElementsByTagName("textarea")[0].scrollTop = 99999;</script>
<% end %>
      <form method="get" action="<%= pcdata(controller .. '/') %>">
        <ul>
          <li>
            <div class="input_container">
              <input class="btTxt submit saveForm advanced" type="submit" name="button" value="Advanced configuration">
            </div>
          </li>
        </ul>
      </form>
    </div>
  </div>
  <!-- #content -->
  <br class="clear"/>
</div>
<!-- #container -->
<script type="text/javascript" charset="utf-8" src="<%= resource %>/arduino/webpanel.ugly.js"></script>
</body>
</html>
